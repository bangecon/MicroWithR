abline(m / p2, -p1 / p2,
col = 'red')
points(equilibrium$pars[1],
equilibrium$pars[2],
col = 'blue',
pch = 20)
200/3
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MRS <- MU1/MU2
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |>
y_rmvars()
MRSsolve1 <- solve(MRS - p1/p2, 'x2')
MRS
simplify(MRS)
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MRS <- MU1/MU2 |>
Simplify() |>
ysum()
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MRS <- MU1/MU2 |>
Simplify() |>
ysym()
MRS <- MU1/MU2 |>
Simplify()
class(MRS)
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MRS <- MU1/MU2 |>
Simplify()
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |>
y_rmvars()
MRS
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MRS <- MU1/MU2 |>
Simplify()
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |>
y_rmvars()
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify()
MU1
MU2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MU1
MU2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1
class(MU21)
class(MU1)
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MRS <- MU1/MU2 |>
Simplify()
MRS
MRS <- yac_str(MU1/MU2) |>
Simplify() |>
ysym()
MRS
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |>
y_rmvars()
BCsolve1 <- solve(dL[[3]], 'x2') |>
y_rmvars()
x1star <- solve(MRSsolve1 - BCsolve1, 'x1') |>
y_rmvars() |>
yac_expr() |>
eval()
BCsolve1
MRSsolve1
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - p1*x1 - p2*x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MRS <- yac_str(MU1/MU2) |>
Simplify() |>
ysym()
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |>
y_rmvars()
MRS
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MRS <- yac_str(MU1/MU2) |>
Simplify() |>
ysym()
MRS
MRSsolve1 <- solve(MRS - 2, 'x2') |>
y_rmvars()
BCsolve1 <- solve(dL[[3]], 'x2') |>
y_rmvars()
x1star <- solve(MRSsolve1 - BCsolve1, 'x1') |>
y_rmvars() |>
yac_expr() |>
eval()
MRSsolve1
MRS
solve(MRS - 2, 'x2')
MRS
MRS - 2
rmvars(MRS - 2)
y_rmvars(MRS - 2)
solve(y_rmvars(MRS - 2)))
solve(y_rmvars(MRS - 2))
solve(y_rmvars(MRS - 2), 'x1')
MRS^2
Simplify(MRS^2)
simplify(MRS^2)
simplify(simplify(MRS^2))
MRS
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MRS <- yac_str(MU1/MU2) |>
Simplify() |>
ysym()
MRSsolve1 <- solve(MRS - 2, 'x2')
MRSsolve1
MRS
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MRS <- yac_str(MU1/MU2) |>
Simplify() |>
ysym() |>
y_rmvars()
MRSsolve1 <- solve(MRS - 2, 'x2')
MRS
MRSsolve1
solve(MRS - 2, 'x2')
MRS-2
y_rmvars(MRS-2)
y_rmvars(ysym(MRS-2))
y_rmvars(MRS)
MRS
MRS^2
solve(MRS = 2, 'x2')
solve(MRS = matrix(2), 'x2')
solve(MRS == matrix(2), 'x2')
solve(ysym(MRS = 2), 'x2')
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MU1 <- solve(dL[[1]], 'lambda')
MU1
L <- ysym('(x1^0.5 + x2^0.5)^2 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MUp1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()
MUp2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()
MRSsolve1 <- solve(MUp1 - MUp2, 'x2')
MRSsolve1
MUp1
MUp2
MUp1/MUp2
Simplify(yac_str(MUp1/MUp2))
Simplify(yac_str(MUp1/MUp2)) |> ysym()
Simplify(yac_str(MUp1/MUp2)) |> ysym() -> MRS
MRS
solve(MRS - 1, "x2")
fuck
L <- ysym('(x1^0.25 + x2^0.25)^4 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MUp1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()
MUp2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()
MRS <- yac_str(MU1/MU2) |>
Simplify() |>
ysym()
MRS
MRSp <- yac_str(MUp1/MUp2) |>
Simplify() |>
ysym()
MRSp
MRSsolve1 <- solve(MRS - 1, 'x2') |>
y_rmvars()
MRSsolve1
L <- ysym('(x1^0.25 + x2^0.25)^4 + lambda*(100 - 2*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
MUp1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()
MUp2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()
MRSp <- yac_str(MUp1/MUp2) |>
Simplify() |>
ysym()
MRSsolve1 <- solve(MRS, 1, 'x2') |>
y_rmvars()
MRSsolve1
MRSp
MRSsolve1 <- solve(MRSp, 1, 'x2') |>
y_rmvars()
MRSsolve1
MRSp
MUpsolve1 <- solve(MUp1, MUp2, 'x2') |>
y_rmvars()
MUpsolve1
motherfucker
library(learnr)
library(gradethis)
library(Ryacas)
library(Deriv)
library(Rsolnp)
gradethis_setup()
tutorial_options(exercise.eval = TRUE, exercise.reveal_solution = TRUE)
knitr::opts_chunk$set(echo = FALSE, fig.align = "center", fig.height = 6, fig.width = 6)
knitr::include_graphics
ux <- function(x) - x[1] ^ (alpha) * x[2] ^ (1 - alpha)
bc <- function(x) p1 * x[1] + p2 * x[2]
alpha = 0.25; p1 = 1.5; p2 = 1; m = 100
equilibrium <- solnp(c(0.01, 0.01), ux, LB = c(0, 0), UB = c(Inf, Inf),
ineqfun = bc, ineqLB = 0, ineqUB = m)
par(mar = c(5, 4, 1, 1))
L <- ysym('x1^(0.25) * x2^(0.75) + lambda*(100 - 1.5*x1 - x2)')
dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda'))
MU1 <- solve(dL[[1]], 'lambda') |> y_rmvars()*p1
MU1 <- yac_str(MU1) |> Simplify() |> ysym()
MU2 <- solve(dL[[2]], 'lambda') |> y_rmvars()*p2
MU2 <- yac_str(MU2) |> Simplify() |> ysym()
MRS <- MU1/MU2
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |> y_rmvars()
BCsolve1 <- solve(dL[[3]], 'x2') |> y_rmvars()
x1star <- solve(MRSsolve1 - BCsolve1, 'x1') |> y_rmvars() |> yac_expr() |> eval()
MRSsolve2 <- solve(MRS - p1/p2, 'x1') |> y_rmvars()
BCsolve2 <- solve(dL[[3]], 'x1') |> y_rmvars()
x2star <- solve(MRSsolve2 - BCsolve2, 'x2') |> y_rmvars() |> yac_expr() |> eval()
lambda <- parse(text = gsub('x2', x2star, gsub('x1', x1star, MU1/p1))) |> eval()
ux <- function(x) {
-x[1] ^ (alpha) * x[2] ^ (1 - alpha)
}
bc <- function(x) {
p1 * x[1] + p2 * x[2]
}
alpha = 0.25
p1 = 1.5
p2 = 1
m = 100
equilibrium <- solnp(
c(0.01, 0.01),
ux,
ineqfun = bc,
ineqLB = 0,
ineqUB = m,
LB = c(0, 0),
UB = c(Inf, Inf),
control = list(trace = 0)
)
curve(
(-tail(equilibrium$values, 1)) ^ (1 / (1 - alpha)) / (x ^ (alpha / (1 - alpha))),
0,
m / p1,
xlab = expression(x[1]),
ylab = expression(x[2]),
xlim = c(0, m / p1),
ylim = c(0, m / p2),
col = 'darkgreen'
)
abline(m / p2, -p1 / p2,
col = 'red')
points(equilibrium$pars[1],
equilibrium$pars[2],
col = 'blue',
pch = 20)
curve(
(1.1 * -tail(equilibrium$values, 1)) ^ (1 / (1 - alpha)) / (x ^ (alpha / (1 - alpha))),
0,
m / p1,
xlab = expression(x[1]),
ylab = expression(x[2]),
xlim = c(0, m / p1),
ylim = c(0, m / p2),
col = 'darkgreen',
add = TRUE,
lty = 'dashed'
)
curve(
(0.9 * -tail(equilibrium$values, 1)) ^ (1 / (1 - alpha)) / (x ^ (alpha / (1 - alpha))),
0,
m / p1,
xlab = expression(x[1]),
ylab = expression(x[2]),
xlim = c(0, m / p1),
ylim = c(0, m / p2),
col = 'darkgreen',
add = TRUE,
lty = 'dashed'
)
text(
equilibrium$pars[1] + 4,
equilibrium$pars[2] + 4,
paste0(
'x = (',
round(equilibrium$pars[1], 2),
', ',
round(equilibrium$pars[2], 2),
')\nu(x) = ',
round(-tail(equilibrium$values, 1), 2)
)
)
text(50,
(1.1 * -tail(equilibrium$values, 1)) ^ (1 / (1 - alpha)) / (50 ^ (alpha / (1 - alpha))) + 3,
paste0('u(x) = ',
round(1.1 * -tail(equilibrium$values, 1), 2)))
text(50,
(0.9 * -tail(equilibrium$values, 1)) ^ (1 / (1 - alpha)) / (50 ^ (alpha / (1 - alpha))) + 3,
paste0('u(x) = ',
round(0.9 * -tail(equilibrium$values, 1), 2)))
L <- ysym('x1^(0.25) * x2^(0.75) + lambda*(100 - 1.5*x1 - x2)')
(dL <- c(deriv(L, 'x1'), deriv(L, 'x2'), deriv(L, 'lambda')))
grade_this({if (!inherits(.result, c("yac_symbol"))) {
fail("Your class of your answer should be a yac_symbol")}
if (.result[1]$yacas_cmd != "0.25*x1^(-0.75)*x2^0.75-1.5*lambda") {
fail("The first FOC should be 0.25*(x2/x1)^0.75-1.5*lambda") }
pass()
})
MU1 <- solve(dL[[1]], 'lambda') |>
y_rmvars()*p1
MU1 <- yac_str(MU1) |>
Simplify() |>
ysym()
MU2 <- solve(dL[[2]], 'lambda') |>
y_rmvars()*p2
MU2 <- yac_str(MU2) |>
Simplify() |>
ysym()
MRS <- MU1/MU2
MRSsolve1 <- solve(MRS - p1/p2, 'x2') |>
y_rmvars()
BCsolve1 <- solve(dL[[3]], 'x2') |>
y_rmvars()
x1star <- solve(MRSsolve1 - BCsolve1, 'x1') |>
y_rmvars() |>
yac_expr() |>
eval()
MRSsolve2 <- solve(MRS - p1/p2, 'x1') |>
y_rmvars()
BCsolve2 <- solve(dL[[3]], 'x1') |>
y_rmvars()
x2star <- solve(MRSsolve2 - BCsolve2, 'x2') |>
y_rmvars() |>
yac_expr() |>
eval()
x1star
x2star
MRSsolve1 <- solve(MRS, p1/p2, 'x2') |>
y_rmvars()
MRSsolve1
BCsolve1 <- solve(dL[[3]], 'x2') |>
y_rmvars()
x1star <- solve(MRSsolve1, BCsolve1, 'x1')
x1star
x1star <- solve(MRSsolve1, BCsolve1, 'x1') |>
y_rmvars() |>
yac_expr() |>
eval()
solve(c(MRSsolve1, MRSsolve2), c(BCsolve1, BCsolve2), c('x1', 'x2'))
675/9
dL
solve(dL, c('x1', 'x2'))
solve(dL, c('x1', 'x2', 'lambda'))
solve(c(dL[[1]], dL[[2]], dL[[3]]), c('x1', 'x2', 'lambda'))
dL
dL[[1]]
c(dL[[1]], dL[[2]], dL[[3]])
c(MRSsolve1, MRSsolve2)
MRS
solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x1', 'x2'))
450/6
75/4.6
75/4.5
solve(dL[[1]], dL[[2]], dL[[3]]), c(0, 0, 0), c('x1', 'x2', 'lambda'))
solve(c(dL[[1]], dL[[2]], dL[[3]]), c(0, 0, 0), c('x1', 'x2', 'lambda'))
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x1', 'x2'))
xStar
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0)
)
xStar
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x2', 'x1'))
xStar
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x2', 'x1')) |> simplify()
xStar
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x2', 'x1'))
xStar
xStar[[2]]
class(xStar)
length(xStar)
xStar[1]
xStar[2]
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x1', 'x2'))
xStar[2]
y_rmvars(xStar)
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x1', 'x2'))
xStar
solve(xstar, 'x1')
solve(xStar, 'x1')
solve(xStar[1], xStar[2] 'x1')
solve(xStar[1], xStar[2], 'x1')
simplify(xStar)
solve(simplify(xStar), c('x1', 'x2'))
solve(simplify(xStar[1]), simplify(xStar[2]), c('x1', 'x2'))
with_value(xStar[1], 'x2', xStar[2])
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x1', 'x2')) |>
y_rmvars
xStar <- solve(c(MRS, dL[[3]]), c(p1/p2, 0), c('x1', 'x2')) |>
y_rmvars()
xStar
with_value(xStar[1], 'x2', xStar[2])
450/27
simplify(with_value(xStar[1], 'x2', xStar[2]))
450/27
450/9
450/6
MU1 |>
with_value('x1', xStar[1])
MU1 |>
with_value('x1', xStar[1]) |>
with_value('x2', xStar[2]) |>
print()
MU1 |>
with_value('x1', xStar[1]) |>
with_value('x2', xStar[2]) |>
simplify()
450./6.)^0.75/(4*(450./27.)^0.75
(450./6.)^0.75/(4*(450./27.)^0.75)
equilibrium$pars
equilibrium$values
